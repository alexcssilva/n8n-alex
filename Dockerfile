FROM n8nio/n8n

ENV NODE_ENV=production
ENV N8N_PORT=5678
ENV WEBHOOK_URL=https://${RAILWAY_STATIC_URL}
ENV N8N_PROTOCOL=https
ENV N8N_HOST=${RAILWAY_STATIC_URL}
ENV N8N_ENCRYPTION_KEY=${N8N_ENCRYPTION_KEY}

# Desativar SQLite explicitamente
ENV DB_SQLITE_DISABLED=true

# Configuração PostgreSQL completa
ENV DB_TYPE=postgresdb
ENV DB_POSTGRESDB_HOST=postgres.railway.internal
ENV DB_POSTGRESDB_DATABASE=railway
ENV DB_POSTGRESDB_USER=postgres
ENV DB_POSTGRESDB_PASSWORD=${DB_POSTGRESDB_PASSWORD}
ENV DB_POSTGRESDB_PORT=5432

ENV N8N_ENFORCE_SETTINGS_FILE_PERMISSIONS=true

EXPOSE 5678
